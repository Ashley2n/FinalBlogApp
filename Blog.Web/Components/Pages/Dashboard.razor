<!-- Pages/Dashboard.razor -->
@page "/"

@using Blog.Domain.Entities
@using Blog.Application.Interfaces

@inject IBlogService BlogService
@inject IUserService UserService

<h3>Blog Dashboard</h3>

@if (posts is null)
{
    <p>Loading...</p>
}
else if (posts.Count == 0)
{
    <p>No posts yet.</p>
}
else
{
    <div class="list-group">
        @foreach (var p in posts)
        {
            <div class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>@p.Title</strong><br />
                    <small>By @p.Author â€” @p.Created.ToLocalTime()</small>
                </div>
                <div class="btn-group">
                    <NavLink class="btn btn-sm btn-outline-primary" href="/post/@p.Id">View more</NavLink>
                </div>
            </div>
        }
    </div>
}

<div class="mt-3">
    <NavLink class="btn btn-success" href="/post/edit">Create new post</NavLink>
</div>

@code {
    private List<BlogPost>? posts;

    protected override async Task OnInitializedAsync()
    {
        posts = await BlogService.GetAllBlogPostsAsync();
    }
}
